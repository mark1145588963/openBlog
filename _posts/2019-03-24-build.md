---
layout: post
title: "å‰ç«¯é¡¹ç›®å¼€å‘ï¼šæ‰“åŒ…ğŸ“¦"
subtitle: 'FE Project, Build'
author: "markzhang"
header-style: text
tags:
  - FE Engineering
---

è¿™ç¯‡æ–‡ç« é¡ºç€ä¸Šä¸Šç¯‡æ–‡ç« å¼€å¤´çš„æ€è·¯æ¢³ç†å…³äºwebpackæ‰“åŒ…æœåŠ¡çš„ç»†èŠ‚ã€‚

å¯¹äºå‰ç«¯æ‰“åŒ…æ€»çš„æ¥è¯´å°±æ˜¯æ‹¿åˆ°å…¥å£ï¼Œåˆ†æå…¥å£æ–‡ä»¶é‡Œé¢çš„å„ç§ä¾èµ–ï¼Œæ‰¾åˆ°ä¾èµ–ï¼Œèšåˆä¾èµ–ï¼Œè¾“å‡ºä¸€ä¸ªæ–‡ä»¶ã€‚

webpackæ˜¯ä¸€ä¸ªæ‰“åŒ…å·¥å…·ï¼ŒæŒ‰ç…§å®ƒè§„å®šçš„å†™æ³•å’Œé…ç½®èƒ½å¸®åŠ©æˆ‘ä»¬å®ç°ä¸Šè¿°åŠŸèƒ½ã€‚webpackçš„é…ç½®å¾ˆå¤šï¼Œä½†æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„é…ç½®å¹¶ä¸æ˜¯å¾ˆå¤šï¼Œæˆ‘ä»¬ä¹¦å†™é…ç½®æ˜¯ä¸ºäº†å‘Šè¯‰webpackåœ¨æ‰“åŒ…çš„æ¯ä¸€ä¸ªç¯èŠ‚ä¸­åº”è¯¥å¦‚ä½•å»æ‰§è¡Œï¼ˆæ¯”å¦‚æŸ¥æ‰¾æ–‡ä»¶çš„è¿‡ç¨‹ã€æ’ä»¶è¿è¡Œçš„é¡ºåºï¼‰ã€‚

åé¢ä¼šèŠ±ä¸€ç¯‡æ–‡ç« æ¢³ç†ä¸‹å…³äºwebpacké…ç½®ç›¸å…³çš„ä¸œè¥¿ï¼Œåœ¨æœ¬ç¯‡æ–‡ç« ä¸­åªå¯¹æ‰“åŒ…æœåŠ¡è¿›è¡Œè®²è¿°ã€‚

å› ä¸ºæˆ‘å¯¹webpackçš„è®¤è¯†å’Œäº†è§£è¿˜ä¸å¤Ÿé€å½»ï¼Œæ‰€ä»¥å¦‚æœæœ‰é”™è¯¯çš„åœ°æ–¹å¸Œæœ›èƒ½é€šè¿‡å³ä¸‹è§’çš„è”ç³»æ–¹å¼å‘Šè¯‰æˆ‘ï¼Œä»¥ä¾¿äºä¸€èµ·ç›¸äº’å­¦ä¹ å’Œæé«˜ã€‚

ä»¥ä¸‹å¼€å¯æ‰“åŒ…æœåŠ¡çš„ä»£ç ï¼š

```javascript
let fs = require('fs'),
    path = require('path'),
    webpack = require('webpack'),
    WebpackDevServer = require('webpack-dev-server'),
    config = require('./webpackConfig'),
    definePluginConfig = require('./definePlugin'),
    entryProperties = require('./entryRule');

let httpsConfig = process.env.PROTOCOL_ENV === 'https' && {
        headers: {
            'X-Custom-Header': 'yes',
            'Access-Control-Allow-Origin': '*'
        },
        https: {
            cert: fs.readFileSync(path.join(__dirname, './cert.pem')),
            key: fs.readFileSync(path.join(__dirname, './key.pem'))
        }
    } || {};

if (process.env.ENTRY_TYPE === 'h5') {
    new WebpackDevServer(
        webpack(Object.assign(
            {},
            config,
            {
                output: Object.assign({}, config.output, entryProperties.output),
                entry: entryProperties.entry,
                resolve: entryProperties.resolve,
                module: entryProperties.moduleLoader,
                plugins: [
                    new webpack.DefinePlugin(definePluginConfig)
                ]
            }
        )),
        Object.assign(
            {}, 
            {
                stats: {
                    chunks: false,
                    colors: true
                },
                inline: true,
                publicPath: '/js/h5',
                disableHostCheck: true,
            },
            httpsConfig
        )
    ).listen(3002);
} else {
    new WebpackDevServer(
        webpack(Object.assign(
                {},
                config,
                {
                    output: Object.assign({}, config.output, entryProperties.output),
                    entry: entryProperties.entry,
                    resolve: entryProperties.resolve,
                    module: entryProperties.moduleLoader,
                    plugins: [
                        new webpack.NoErrorsPlugin(),
                        new webpack.DefinePlugin(definePluginConfig)
                    ]    
                }
            )
        ),
        Object.assign(
            {},
            {
                stats: {
                    chunks: false,
                    colors: false
                },
                inline: true,
                publicPath: '/js/pc',
                disableHostCheck: true
            },
            httpsConfig
        )
    ).listen(9090);
}
```